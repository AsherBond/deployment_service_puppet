APP_ROOT = "/data/<%= name %>"

worker_processes 3
working_directory APP_ROOT + "/current"

preload_app true

timeout 60

listen APP_ROOT + "/shared/sockets/unicorn.sock", :backlog => 64

pid APP_ROOT + "/shared/pids/unicorn.pid"

stderr_path APP_ROOT + "/shared/log/unicorn.stderr.log"
stdout_path APP_ROOT + "/shared/log/unicorn.stdout.log"

after_fork do |server, worker|
  defined?(ActiveRecord::Base) && ActiveRecord::Base.establish_connection
end
